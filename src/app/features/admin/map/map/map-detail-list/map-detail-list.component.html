<app-sub-header [menuItems]="navArray"></app-sub-header>

<div class="content pt-3">
  <mat-sidenav-container class="sidenav-container" hasBackdrop="false">
    <mat-sidenav-content>
      <div class="container-fluid">
        <div class="row">
          <div class="col-12 px-0">
            <div class="card border">
              <div class="card-header" *ngIf="mapDetail">
                <h3>
                  <span class="title">{{ "MAP.mapDetail.titleDetail" | translate }}:
                    {{ mapDetail.mapTitle }}</span>
                </h3>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-6">
                    <mat-tab-group style="min-height: 30vh;" (selectedTabChange)="onChangeTab($event)">
                      <!-- Map detail -->
                      <mat-tab [label]="'MAP.mapDetail.generalInfo' | translate">
                        <div class="content-inner" class="mt-3">
                          <div class="group-layer-detail" *ngIf="mapDetail">
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.mapTitle" | translate }}:</label>
                              <label class="col-sm-9 col-form-label"><strong>{{
                                  mapDetail.mapTitle
                                }}</strong></label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.description" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong [innerHtml]="mapDetail.mapAbstract"></strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.status" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>
                                  <span *ngIf="mapDetail.status !== null" [ngClass]="{
                                      label: true,
                                      'label-success': mapDetail.status === 1,
                                      'label-default': mapDetail.status !== 1
                                    }">
                                    {{
                                      mapDetail.status
                                        | getFieldValueFromArrayObject
                                          : mapStatus
                                          : "name"
                                    }}
                                  </span>
                                </strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.extentMinx" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>{{ mapDetail.extentMinx }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.extentMaxx" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>{{ mapDetail.extentMaxx }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.extentMiny" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>{{ mapDetail.extentMiny }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.extentMaxy" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>{{ mapDetail.extentMaxy }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.center" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>{{ mapDetail.center }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.unit" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                {{
                                  mapDetail.unit
                                    | getFieldValueFromArrayObject
                                      : mapUnits
                                      : "name"
                                }}
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.sizeX" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>{{ mapDetail.sizeX }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.sizeY" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>{{ mapDetail.sizeY }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.projection" | translate }}:</label>
                              <label class="col-sm-9 col-form-label" *ngIf="projectionDetail !== undefined">
                                <strong>{{ projectionDetail.prjName }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.webMinscale" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>{{ mapDetail.webMinscale }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.webMaxscale" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>{{ mapDetail.webMaxscale }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label
                                class="col-sm-3 col-form-label text-right">{{ "MAP.map.zoomLevel" | translate }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <strong>{{ mapDetail.zoomLevel }}</strong>
                              </label>
                            </div>
                            <div class="row mx-0">
                              <label class="col-sm-3 col-form-label text-right">{{
                                  "MAP.map.refImageLink" | translate
                                }}:</label>
                              <label class="col-sm-9 col-form-label">
                                <img width="100%" src="{{ mapDetail.refImageLink }}" alt="" />
                              </label>
                            </div>
                          </div>
                        </div>
                      </mat-tab>
                      <!-- Layer groups list -->
                      <mat-tab [label]="
                          'MAP.mapDetail.layerAndGroupLayerMap' | translate
                        ">
                        <div class="content-inner" class="mt-3">
                          <div class="btn-add text-right">
                            <div class="btn-group">
                              <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown"
                                aria-expanded="false">
                                <i class="fal fa-plus-square"></i>
                                {{
                                  "MAP.mapDetail.addLayerAndGroupLayer"
                                    | translate
                                }}
                              </button>
                              <div class="dropdown-menu dropdown-menu-right">
                                <a href="javascript:void(0)" class="dropdown-item" [ngClass]="{
                                    disabled: !addMapLayerLayerIdsAction
                                  }" (click)="addExistingLayer()">
                                  {{
                                    "MAP.mapDetail.addLayerExist" | translate
                                  }}
                                </a>
                                <div class="dropdown-divider"></div>
                                <a href="javascript:void(0)" class="dropdown-item" [ngClass]="{
                                    disabled: !addLayerGroupsAction
                                  }" (click)="addNewLayerGroup()">
                                  {{
                                    "MAP.mapDetail.addGroupLayer" | translate
                                  }}
                                </a>
                                <a href="javascript:void(0)" class="dropdown-item" [ngClass]="{
                                    disabled: !addMapLayerLayerGroupIdsAction
                                  }" (click)="addExistingLayerGroup()">
                                  {{
                                    "MAP.mapDetail.addGroupLayerExist"
                                      | translate
                                  }}
                                </a>
                              </div>
                            </div>
                            <button class="btn btn-primary ml-3" (click)="saveLayerAndGroup()">
                              <i class="far fa-save"></i>
                              {{ "MAP.mapDetail.saveInfo" | translate }}
                            </button>
                            <div class="clearfix"></div>
                          </div>
                          <div class="layer-list mt-3">
                            <app-layer-tree #layerTree id="map-detail" [actionType]="'button'"
                              [allowRowDragAndDrop]="true" [dataSource]="listItems"
                              (rowDataBound)="rowDataBound($event)">
                            </app-layer-tree>
                          </div>
                        </div>
                      </mat-tab>
                    </mat-tab-group>
                  </div>
                  <div class="col-6">
                    <mat-tab-group>
                      <mat-tab [label]="'MAP.mapDetail.previewMap' | translate">
                        <ng-template matTabContent>
                          <div class="content-inner" class="mt-3">
                            <div id="mapShow" style="width: 100%; height: 70vh;"></div>
                          </div>
                        </ng-template>
                      </mat-tab>
                    </mat-tab-group>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <mat-sidenav #aside [fixedInViewport]="true" [fixedTopGap]="50" class="aside" position="end"
        style="width: 600px;">
        <div class="p-2 pl-3 bg-primary text-white mat-sidenav-title">
          <button class="btn btn-sm btn-light" (click)="closeIOSidebar()">
            <i class="fad fa-chevron-double-right"></i>
          </button>
          <span style="vertical-align: middle;"
            class="ml-3 mat-sidenav-title-text">{{ matSidenavService.sidenavTitle }}</span>
        </div>
        <template #ioSidebar> </template>
      </mat-sidenav>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>